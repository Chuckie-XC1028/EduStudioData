2023-12-05 11:21:23[INFO]: ============================================================
2023-12-05 11:21:23[INFO]: [ID]: 2023-12-05-112122
2023-12-05 11:21:23[INFO]: [DATASET]: ASSIST_0910
2023-12-05 11:21:23[INFO]: [ARGV]: ['run_dkt_dsc_demo.py']
2023-12-05 11:21:23[INFO]: [ALL_CFG]: 
{
    "traintpl_cfg": {
        "cls": "EduTrainTPL",
        "num_stop_rounds": 10,
        "early_stop_metrics": [
            [
                "auc",
                "max"
            ]
        ],
        "best_epoch_metric": "auc",
        "unsave_best_epoch_pth": true,
        "ignore_metrics_in_train": [],
        "batch_size": 32,
        "device": "cpu",
        "epoch_num": 100,
        "eval_batch_size": 2048,
        "num_workers": 0,
        "lr": 0.001,
        "optim": "adam",
        "eps": 1e-08,
        "weight_decay": 0.0,
        "seed": 2023
    },
    "datatpl_cfg": {
        "cls": "DKTDSCDataTPL",
        "mid2cache_op_seq": [
            "M2C_CptAsExer",
            "M2C_Label2Int",
            "M2C_ReMapId",
            "M2C_BuildSeqInterFeats",
            "M2C_DKTDSC_OP"
        ],
        "exer_exclude_feat_names": [],
        "stu_exclude_feat_names": [],
        "seperator": ",",
        "n_folds": 1,
        "is_dataset_divided": false,
        "is_save_cache": false,
        "cache_id": "cache_default",
        "load_data_from": "middata",
        "inter_exclude_feat_names": [],
        "raw2mid_op": null,
        "seed": 2023,
        "M2C_CptAsExer": {},
        "M2C_Label2Int": {},
        "M2C_ReMapId": {
            "share_id_columns": [],
            "ignore_columns": "{'order_id:token'}"
        },
        "M2C_BuildSeqInterFeats": {
            "seed": 2023,
            "divide_by": "stu",
            "window_size": 100,
            "divide_scale_list": [
                7,
                1,
                2
            ],
            "extra_inter_feats": []
        },
        "M2C_DKTDSC_OP": {
            "n_cluster": 7,
            "centroids_update_epoch": 2,
            "seg_length": 20
        }
    },
    "modeltpl_cfg": {
        "cls": "DKTDSC",
        "emb_size": 200,
        "hidden_size": 200,
        "num_layers": 1,
        "dropout_rate": 0.5,
        "rnn_or_lstm": "lstm",
        "param_init_type": "xavier_normal",
        "pretrained_file_path": ""
    },
    "evaltpl_cfg": {
        "clses": [
            "BinaryClassificationEvalTPL"
        ],
        "BinaryClassificationEvalTPL": {
            "use_metrics": [
                "auc",
                "acc",
                "rmse"
            ]
        }
    },
    "frame_cfg": {
        "ARCHIVE_FOLDER_PATH": "/home/u2022171244/EduStudio-main/examples/single_model/archive",
        "CFG_FOLDER_PATH": "/home/u2022171244/EduStudio-main/examples/single_model/conf",
        "DATA_FOLDER_PATH": "/home/u2022171244/EduStudio-main/examples/single_model/data",
        "DISABLE_LOG_STDOUT": false,
        "DISABLE_TQDM_BAR": false,
        "DT_INFO_DICT": {},
        "DT_INFO_FILE_PATH": "/home/u2022171244/EduStudio-main/edustudio/assets/datasets.yaml",
        "ID": "2023-12-05-112122",
        "LOG_WITHOUT_DATE": false,
        "TEMP_FOLDER_PATH": "/home/u2022171244/EduStudio-main/examples/single_model/temp",
        "TQDM_NCOLS": 100,
        "WORK_DIR": "/home/u2022171244/EduStudio-main/examples/single_model",
        "data_folder_path": "/home/u2022171244/EduStudio-main/examples/single_model/data/ASSIST_0910",
        "temp_folder_path": "/home/u2022171244/EduStudio-main/examples/single_model/temp/ASSIST_0910/EduTrainTPL/DKTDSC/2023-12-05-112122",
        "archive_folder_path": "/home/u2022171244/EduStudio-main/examples/single_model/archive/ASSIST_0910/EduTrainTPL/DKTDSC"
    },
    "dataset": "ASSIST_0910",
    "logger": "<Logger edustudio (DEBUG)>"
}
2023-12-05 11:21:23[INFO]: ============================================================
2023-12-05 11:21:31[INFO]: {'stu_count': 4163, 'exer_count': 153, 'real_window_size': 100, 'n_cluster': 7}
2023-12-05 11:21:31[INFO]: TrainTPL <class 'edustudio.traintpl.edu_traintpl.EduTrainTPL'> Started!
2023-12-05 11:21:31[INFO]: ====== [FOLD ID]: 0 ======
2023-12-05 11:21:31[INFO]: [CALLBACK]-ModelCheckPoint has been registered!
2023-12-05 11:21:31[INFO]: [CALLBACK]-EarlyStopping has been registered!
2023-12-05 11:21:31[INFO]: [CALLBACK]-History has been registered!
2023-12-05 11:21:31[INFO]: [CALLBACK]-BaseLogger has been registered!
2023-12-05 11:21:31[INFO]: Start Training...
2023-12-05 11:21:52[INFO]: Update best epoch as [1] for auc!
2023-12-05 11:21:52[INFO]: [EPOCH=001]: loss_main: 0.6062
2023-12-05 11:21:52[INFO]: [EPOCH=001]: auc: 0.7222 | acc: 0.7067 | rmse: 0.4417
2023-12-05 11:22:13[INFO]: Update best epoch as [2] for auc!
2023-12-05 11:22:13[INFO]: [EPOCH=002]: loss_main: 0.5708
2023-12-05 11:22:13[INFO]: [EPOCH=002]: auc: 0.7348 | acc: 0.7127 | rmse: 0.4366
2023-12-05 11:22:33[INFO]: Update best epoch as [3] for auc!
2023-12-05 11:22:33[INFO]: [EPOCH=003]: loss_main: 0.5648
2023-12-05 11:22:33[INFO]: [EPOCH=003]: auc: 0.7376 | acc: 0.7155 | rmse: 0.4354
2023-12-05 11:22:54[INFO]: Update best epoch as [4] for auc!
2023-12-05 11:22:54[INFO]: [EPOCH=004]: loss_main: 0.5605
2023-12-05 11:22:54[INFO]: [EPOCH=004]: auc: 0.7385 | acc: 0.7168 | rmse: 0.4351
2023-12-05 11:23:15[INFO]: Update best epoch as [5] for auc!
2023-12-05 11:23:15[INFO]: [EPOCH=005]: loss_main: 0.5578
2023-12-05 11:23:15[INFO]: [EPOCH=005]: auc: 0.7393 | acc: 0.7165 | rmse: 0.4344
2023-12-05 11:23:36[INFO]: Update best epoch as [6] for auc!
2023-12-05 11:23:36[INFO]: [EPOCH=006]: loss_main: 0.5542
2023-12-05 11:23:36[INFO]: [EPOCH=006]: auc: 0.7421 | acc: 0.7154 | rmse: 0.4335
2023-12-05 11:23:58[INFO]: [EPOCH=007]: loss_main: 0.5524
2023-12-05 11:23:58[INFO]: [EPOCH=007]: auc: 0.7407 | acc: 0.7150 | rmse: 0.4344
2023-12-05 11:24:20[INFO]: [EPOCH=008]: loss_main: 0.5500
2023-12-05 11:24:20[INFO]: [EPOCH=008]: auc: 0.7413 | acc: 0.7148 | rmse: 0.4346
2023-12-05 11:24:41[INFO]: Update best epoch as [9] for auc!
2023-12-05 11:24:41[INFO]: [EPOCH=009]: loss_main: 0.5477
2023-12-05 11:24:41[INFO]: [EPOCH=009]: auc: 0.7427 | acc: 0.7179 | rmse: 0.4331
2023-12-05 11:25:01[INFO]: Update best epoch as [10] for auc!
2023-12-05 11:25:01[INFO]: [EPOCH=010]: loss_main: 0.5462
2023-12-05 11:25:01[INFO]: [EPOCH=010]: auc: 0.7438 | acc: 0.7175 | rmse: 0.4326
2023-12-05 11:25:23[INFO]: [EPOCH=011]: loss_main: 0.5430
2023-12-05 11:25:23[INFO]: [EPOCH=011]: auc: 0.7437 | acc: 0.7171 | rmse: 0.4328
2023-12-05 11:25:43[INFO]: [EPOCH=012]: loss_main: 0.5390
2023-12-05 11:25:43[INFO]: [EPOCH=012]: auc: 0.7426 | acc: 0.7146 | rmse: 0.4334
2023-12-05 11:26:04[INFO]: Update best epoch as [13] for auc!
2023-12-05 11:26:04[INFO]: [EPOCH=013]: loss_main: 0.5353
2023-12-05 11:26:04[INFO]: [EPOCH=013]: auc: 0.7444 | acc: 0.7187 | rmse: 0.4326
2023-12-05 11:26:25[INFO]: [EPOCH=014]: loss_main: 0.5310
2023-12-05 11:26:25[INFO]: [EPOCH=014]: auc: 0.7431 | acc: 0.7153 | rmse: 0.4331
2023-12-05 11:26:46[INFO]: Update best epoch as [15] for auc!
2023-12-05 11:26:46[INFO]: [EPOCH=015]: loss_main: 0.5277
2023-12-05 11:26:46[INFO]: [EPOCH=015]: auc: 0.7448 | acc: 0.7165 | rmse: 0.4326
2023-12-05 11:27:08[INFO]: [EPOCH=016]: loss_main: 0.5228
2023-12-05 11:27:08[INFO]: [EPOCH=016]: auc: 0.7439 | acc: 0.7167 | rmse: 0.4332
2023-12-05 11:27:29[INFO]: [EPOCH=017]: loss_main: 0.5161
2023-12-05 11:27:29[INFO]: [EPOCH=017]: auc: 0.7423 | acc: 0.7174 | rmse: 0.4341
2023-12-05 11:27:50[INFO]: Update best epoch as [18] for auc!
2023-12-05 11:27:50[INFO]: [EPOCH=018]: loss_main: 0.5090
2023-12-05 11:27:50[INFO]: [EPOCH=018]: auc: 0.7458 | acc: 0.7158 | rmse: 0.4342
2023-12-05 11:28:11[INFO]: [EPOCH=019]: loss_main: 0.5015
2023-12-05 11:28:11[INFO]: [EPOCH=019]: auc: 0.7434 | acc: 0.7145 | rmse: 0.4354
2023-12-05 11:28:33[INFO]: [EPOCH=020]: loss_main: 0.4902
2023-12-05 11:28:33[INFO]: [EPOCH=020]: auc: 0.7456 | acc: 0.7154 | rmse: 0.4352
2023-12-05 11:28:54[INFO]: [EPOCH=021]: loss_main: 0.4793
2023-12-05 11:28:54[INFO]: [EPOCH=021]: auc: 0.7455 | acc: 0.7161 | rmse: 0.4359
2023-12-05 11:29:14[INFO]: Update best epoch as [22] for auc!
2023-12-05 11:29:14[INFO]: [EPOCH=022]: loss_main: 0.4662
2023-12-05 11:29:14[INFO]: [EPOCH=022]: auc: 0.7481 | acc: 0.7137 | rmse: 0.4367
2023-12-05 11:29:35[INFO]: Update best epoch as [23] for auc!
2023-12-05 11:29:35[INFO]: [EPOCH=023]: loss_main: 0.4546
2023-12-05 11:29:35[INFO]: [EPOCH=023]: auc: 0.7491 | acc: 0.7157 | rmse: 0.4378
2023-12-05 11:29:56[INFO]: Update best epoch as [24] for auc!
2023-12-05 11:29:56[INFO]: [EPOCH=024]: loss_main: 0.4415
2023-12-05 11:29:56[INFO]: [EPOCH=024]: auc: 0.7492 | acc: 0.7154 | rmse: 0.4387
2023-12-05 11:30:18[INFO]: [EPOCH=025]: loss_main: 0.4285
2023-12-05 11:30:18[INFO]: [EPOCH=025]: auc: 0.7483 | acc: 0.7179 | rmse: 0.4399
2023-12-05 11:30:39[INFO]: [EPOCH=026]: loss_main: 0.4155
2023-12-05 11:30:39[INFO]: [EPOCH=026]: auc: 0.7490 | acc: 0.7185 | rmse: 0.4409
2023-12-05 11:31:01[INFO]: [EPOCH=027]: loss_main: 0.4021
2023-12-05 11:31:01[INFO]: [EPOCH=027]: auc: 0.7490 | acc: 0.7189 | rmse: 0.4431
2023-12-05 11:31:22[INFO]: [EPOCH=028]: loss_main: 0.3911
2023-12-05 11:31:22[INFO]: [EPOCH=028]: auc: 0.7476 | acc: 0.7147 | rmse: 0.4453
2023-12-05 11:31:43[INFO]: [EPOCH=029]: loss_main: 0.3780
2023-12-05 11:31:43[INFO]: [EPOCH=029]: auc: 0.7461 | acc: 0.7165 | rmse: 0.4471
2023-12-05 11:32:04[INFO]: Update best epoch as [30] for auc!
2023-12-05 11:32:04[INFO]: [EPOCH=030]: loss_main: 0.3661
2023-12-05 11:32:04[INFO]: [EPOCH=030]: auc: 0.7498 | acc: 0.7201 | rmse: 0.4459
2023-12-05 11:32:25[INFO]: [EPOCH=031]: loss_main: 0.3550
2023-12-05 11:32:25[INFO]: [EPOCH=031]: auc: 0.7460 | acc: 0.7156 | rmse: 0.4506
2023-12-05 11:32:46[INFO]: Update best epoch as [32] for auc!
2023-12-05 11:32:46[INFO]: [EPOCH=032]: loss_main: 0.3463
2023-12-05 11:32:46[INFO]: [EPOCH=032]: auc: 0.7523 | acc: 0.7202 | rmse: 0.4481
2023-12-05 11:33:07[INFO]: [EPOCH=033]: loss_main: 0.3331
2023-12-05 11:33:07[INFO]: [EPOCH=033]: auc: 0.7480 | acc: 0.7168 | rmse: 0.4525
2023-12-05 11:33:28[INFO]: [EPOCH=034]: loss_main: 0.3230
2023-12-05 11:33:28[INFO]: [EPOCH=034]: auc: 0.7444 | acc: 0.7151 | rmse: 0.4549
2023-12-05 11:33:48[INFO]: [EPOCH=035]: loss_main: 0.3134
2023-12-05 11:33:48[INFO]: [EPOCH=035]: auc: 0.7508 | acc: 0.7227 | rmse: 0.4516
2023-12-05 11:34:10[INFO]: [EPOCH=036]: loss_main: 0.3109
2023-12-05 11:34:10[INFO]: [EPOCH=036]: auc: 0.7479 | acc: 0.7164 | rmse: 0.4554
2023-12-05 11:34:31[INFO]: [EPOCH=037]: loss_main: 0.2962
2023-12-05 11:34:31[INFO]: [EPOCH=037]: auc: 0.7468 | acc: 0.7151 | rmse: 0.4588
2023-12-05 11:34:52[INFO]: [EPOCH=038]: loss_main: 0.2902
2023-12-05 11:34:52[INFO]: [EPOCH=038]: auc: 0.7468 | acc: 0.7175 | rmse: 0.4590
2023-12-05 11:35:13[INFO]: [EPOCH=039]: loss_main: 0.2826
2023-12-05 11:35:13[INFO]: [EPOCH=039]: auc: 0.7461 | acc: 0.7147 | rmse: 0.4614
2023-12-05 11:35:34[INFO]: [EPOCH=040]: loss_main: 0.2725
2023-12-05 11:35:34[INFO]: [EPOCH=040]: auc: 0.7456 | acc: 0.7164 | rmse: 0.4629
2023-12-05 11:35:55[INFO]: [EPOCH=041]: loss_main: 0.2640
2023-12-05 11:35:55[INFO]: [EPOCH=041]: auc: 0.7460 | acc: 0.7171 | rmse: 0.4622
2023-12-05 11:36:17[INFO]: Suggest to stop training now
2023-12-05 11:36:17[INFO]: [EPOCH=042]: loss_main: 0.2579
2023-12-05 11:36:17[INFO]: [EPOCH=042]: auc: 0.7446 | acc: 0.7171 | rmse: 0.4652
2023-12-05 11:36:17[INFO]: ==============================
2023-12-05 11:36:17[INFO]: [For auc], the Best Epoch is: 32, the value=0.7523
2023-12-05 11:36:17[INFO]: [EPOCH=032]: loss_main: 0.3463
2023-12-05 11:36:17[INFO]: [EPOCH=032]: auc: 0.7523 | acc: 0.7202 | rmse: 0.4481
2023-12-05 11:36:17[INFO]: ==============================
2023-12-05 11:36:17[INFO]: Training Completed!
2023-12-05 11:36:18[INFO]: auc: 0.783002927364205
2023-12-05 11:36:18[INFO]: acc: 0.7391788420970389
2023-12-05 11:36:18[INFO]: rmse: 0.4328327201774777
2023-12-05 11:36:18[INFO]: ====================
2023-12-05 11:36:18[INFO]: All Fold Mean auc = 0.783002927364205
2023-12-05 11:36:18[INFO]: All Fold Mean acc = 0.7391788420970389
2023-12-05 11:36:18[INFO]: All Fold Mean rmse = 0.4328327201774777
2023-12-05 11:36:18[INFO]: Task: 2023-12-05-112122 Completed!
